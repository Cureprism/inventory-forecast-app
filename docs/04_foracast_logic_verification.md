# 在庫予測ロジック検証ドキュメント

本ドキュメントは、在庫予測ロジック（ForecastService）が  
仕様どおりに動作しているかを確認するための数値ベースの検証記録である。

## 1. 検証に使用した前提データ

### 1.1 基準日
- `.env` 設定：`FORECAST_BASE_DATE=2025-11-15`

### 1.2 商品情報（サンプルデータ）
- **商品名**：シャープペン替芯 HB  
- **商品管理番号**：S12345HB  
- **安全在庫**：10  
- **リードタイム**：3日  

### 1.3 入出庫データ
**入庫**  
- 2025-11-01 → 100個  

**出庫**  
- 2025-11-02〜2025-11-15（14日間）→ 毎日5個ずつ（合計70個）

### 1.4 在庫
- 在庫：100（入庫） - 70（出庫） = 30

## 2. 平均日次出庫量の算出（forecastDailyDemand）

### 2.1 対象期間
- `$to`：**2025-11-15**  
- `$from`：2025-11-15 - (14 - 1)日 = **2025-11-02**

### 2.2 出庫合計
- 5個 × 14日 = **70個**

### 2.3 平均日次出庫量（avgDaily）
- avgDaily = 70 / 14 = **5.0**

## 3. 発注推奨日の算出（simulateStockout）

### 3.1 現在庫の確定
- current_stock = **30**

### 3.2 安全在庫到達までの日数（daysToSafety）
- (30 - 10) / 5 = **4日**

### 3.3 在庫枯渇までの日数（daysToZero）
- 30 / 5 = **6日**

### 3.4 在庫切れ日（stockoutDate）
- 2025-11-15 + 6日 = **2025-11-21**

### 3.5 リードタイムから逆算した発注最遅日（reorderBaseDays）
- daysToZero - lead_time = 6 - 3 = **3日後**

### 3.6 安全在庫割れも考慮した発注推奨日数（reorderDays）
- min(3, 4) = **3**

### 3.7 発注推奨日（reorderDate）
- 2025-11-15 + 3日 = **2025-11-18**
